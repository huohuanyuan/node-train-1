<!doctype>
<html>

<head>
    <title>promise animation</title>
    <style>
        .ball {
            width: 40px;
            height: 40px;
            border-radius: 20px;
        }
        .ball1 {
            background: red;
        }
        .ball2 {
            background: yellow;
        }
        .ball3 {
            background: green;
        }
    </style>
</head>

<body>
    <div class="ball ball1" style="margin-left:0"></div>
    <div class="ball ball2" style="margin-left:0"></div>
    <div class="ball ball3" style="margin-left:0"></div>
</body>
<script>
    var ball1 = document.querySelector(".ball1");
    var ball2 = document.querySelector(".ball2");
    var ball3 = document.querySelector(".ball3");
    /**
     * 动画函数
     * ball 球
     * distance：位置，将球移动到哪里
     * cb：回调函数
     * 
    */
    function animate(ball, distance, cb) {
        setTimeout(function () {
            //球现在距离左边距的长度
            var marginLeft = parseInt(ball.style.marginLeft, 10)
            //如果左边距移动到和传入的distance距离相同时，说明球已经运动到我们期望的点，说明动画执行完毕
            if (marginLeft === distance) {
                cb && cb();
            } else {
                if (marginLeft < distance) {
                    marginLeft++;
                } else {
                    marginLeft--;
                }
                ball.style.marginLeft = marginLeft+"px";
                animate(ball, distance, cb)
            }
        }, 13)
    }
    animate(ball1, 100, function () {
        animate(ball2, 200, function () {
            animate(ball3, 300, function () {
                animate(ball3, 150, function () {
                    animate(ball2, 150, function () {
                        animate(ball1, 150, function () {

                        })
                    })
                })
            })
        })
    })


    
</script>

</html>